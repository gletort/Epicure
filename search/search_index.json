{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"EpiCure","text":""},{"location":"#installation","title":"Installation","text":"<p>You can install EpiCure with pip: <code>pip install epicure</code> in a python virtual environment. For more precision about the installation, see the Installation page.</p>"},{"location":"#usage","title":"Usage","text":"<p>You can launch <code>EpiCure</code> in Napari by going to <code>Plugins&gt;epicure&gt;Start</code>. It will open an interface at the right side of the window where you can select the files to use. </p> <p>The first file to choose is the movie containing the epithelial staining.  It should be 2D(+time), .tif file. </p> <p>The second file is the segmentation of this movie (also a <code>.tif</code> file). It can be a binarized file of the junctions (skeletonized) or a labelled file (each cell is filled by a unique number). Note that if you haven't done the segmentation yet, there's an additional option in EpiCure to directly run EpySeg on the loaded movie. </p> <p>Additionnal options are available to tune it to your usage, please see Start epicure page for more informations.</p> <p>Then click on <code>START CURE</code> to start the main process.</p>"},{"location":"#main-interface","title":"Main interface","text":"<p>When you have selected the two files, you can start editing by clicking on the <code>Start cure</code> button. It will open the two movies and open the interface that let you choose the steps to do:</p> <ul> <li>Edit: clean the segmentation or correct manually errors through EpiCure options  </li> <li>Inspect: determine cells suspicious of having an error, based on a few morphological or track features, or handle cellular events as divisions  </li> <li>Track: links the labels from one frame to another to reconstruct the whole cell track. </li> <li>Output: measure/display cell or track features, export results to other plugins/softwares  </li> <li>Display: display additional informations (segmentation skeleton, general informations...) or a spatial grid  </li> <li>Preferences: to set-up user-specific preferences as keyboard shortcuts  </li> </ul>"},{"location":"#general-principle","title":"General principle","text":"<p>In EpiCure, the segmented cells are represented as labels: each cell is assigned a unique number, that will be conserved in all time frames that the cell is present. All pixels belonging to the cell are assigned to its value.  They are represented in EpiCure in a Napari Label layer called <code>Segmentation</code>.</p> <p><code>Tracks</code> displays the trajectory of each cell by marking its centroid at each time frame. The value of a track is the same as the cell label.</p> <p><code>Inspect</code> helps the user to correct the segmentation by flagging some cell that might be wrongly segmented or handling other cellular events as divisions. </p> <p>EpiCure has several keyboard or mouse shortcuts to allow interactive corrections. EpiCure shortcuts are linked to the <code>Segmentation</code> layer, so it should be selected in Napari for the shortcuts to work.</p>"},{"location":"#shortcut-customisation","title":"Shortcut customisation","text":"<p>You can redefine EpiCure shortcuts to put your favorite keys instead of EpiCure default ones. For this, open the <code>Preferences</code> option in <code>Napari&gt;Plugins&gt;EpiCure&gt;Edit preferences</code>. Choose the shortcuts to use and save them.  See the Preferences page for more information.</p> Restart to activate shortcut configuration <p>The new shortcut configuration will be active only at the next EpiCure session. If you already have an EpiCure opened, restart it to apply the new shortcuts.</p>"},{"location":"#general-options","title":"General options","text":"<ul> <li> <p>Press s to save the current state of the segmentation. The file will be saved in the output folder, named <code>**imagename**_labels.tif</code> and can be reloaded later. Additional informations specific to EpiCure (cell groups, tracks graph (lineage), suspects) are saved at the same time, in a file named <code>**imagename**_epidata.pkl</code>. When the EpiCure files are re-opened, this file will be reloaded. </p> </li> <li> <p>Press h to show/hide the main <code>EpiCure</code> shortcuts list. Press it several times to go through the different shortcut lists.</p> </li> <li> <p>Press a to open a new op-up window that list ALL the EpiCure shortcuts.</p> </li> <li> <p>Press Shift-s to save screenshots of the whole movie, with the current display. </p> </li> </ul>"},{"location":"#visualization-shortcuts","title":"Visualization  shortcuts:","text":"<ul> <li>The labels (cells) can be displayed as filled areas (put <code>contour</code> to 0) or only the contour lines can be shown with the <code>contour</code> option.  Shortcut: Ctrl-c or Ctrl-d to increase (or decrease) the <code>contour</code> size. </li> <li>To see only the current label (the pixels which have the value that is currently active in the <code>label</code> field), check the <code>show selected</code> box on the left panel.</li> <li>Click on the eye icon next to the <code>Movie</code> layer to show/hide it. Shortcut: press v to show/hide the movie (visible).</li> <li>Click on the eye icon next to the <code>Segmentation</code> layer to show/hide it. Shortcut: press b to show/hide the segmentation (binary).</li> <li>Press 5 to switch to zoom/moving mode.</li> <li>Press c to see only the movie layer.</li> <li>Press g to show/hide a grid to have a spatial repere. See Display documentation for more details.</li> </ul>"},{"location":"#additional-options","title":"Additional options","text":"<p>EpiCure also proposes specific options outside of the main pipeline:</p> <ul> <li>Concatenate EpiCured movies: to combine two movies (from the same original one that was splitted before temporally) already analysed with EpiCure into one big epicured movie. This is usefull for huge movie where the user prefered to split it in sub-movies temporally to reduce the loaded data size and allow for more responsiveness of the interface.</li> <li>Segment: by default, EpiCure doesn't perform segmentation to allow for more generability by using already existing solutions. This option links directly EpiCure with napari-epyseg plugin to perform the segmentation directly.</li> </ul>"},{"location":"Concatenate-epicured-movies/","title":"Concatenate movies","text":"<p>Merge temporally two EpiCured movies</p> <p>_ Start it with <code>Napari&gt;Plugins&gt;EpiCure&gt;Concatenate EpiCured movies</code>_</p> <p>To treat a huge movie, it can be convenient to split it temporally in two (or more movies). You can then correct each movie with EpiCure, and recombine it with this option.  This option can be started in <code>Napari&gt;Plugins&gt;EpiCure&gt;Concatenate EpiCured movies</code>.</p> <ul> <li>Choose the first movie and its corresponding segmentation (and EpiCure .pkl file).</li> <li>Choose the second movie and its corresponding segmentation (and EpiCure .pkl file).</li> <li>Choose the name of the resulting movie that will be the concatenation of the two movie.</li> </ul> <p>EpiCure will create a new movie and segmentation containing the full movie. The EpiCure additional informations as cell's group, track and lineage will also be merged in the new movie.</p> <p>One frame must be shared between the two movies</p> <p>Note that two merge the two movie, you need to keep one common frame: the last frame of the first movie must be the first frame of the second movie. </p>"},{"location":"Display/","title":"Display","text":"<p>Display settings </p> <p>Select the <code>Display</code> ongler or use dedicated shortcuts to setup the display</p> <p>You can manage the display with several shortcuts to be able to rapidly switch the current view, but also some general options are available in the interface in the <code>Display</code> onglet.</p> <ul> <li><code>Measure line</code> option, can be started with Control+i to measure the length of a drawn line. Press the shortcut, then draw the line by left clicking and dragging the line. When you release the mouse button, the line will disappear and the measure of its length will be displayed in the top left part of the window.</li> <li><code>Show summary</code> opens a pop-up text window that contains general information about the movie as the size of the movie, the number of cells, the average cell area, the average track duration..</li> <li><code>Side by side view</code>: by default all layer are overlaid. To split the layers in two side by side view, select the <code>side-by-side view</code> parameter and choose the views to be placed horizontally or vertically. Uncheck it to be back to a single view.</li> <li><code>Set current settings as default</code>: save all the current settings (display parameters, option parameters) in the settings file so that next time EpiCure is loaded, it will be in the same state.  For example, if you preferably look at the segmentation with only contours visible with a given width, it will directly load it to this state.</li> </ul>"},{"location":"Display/#segmentation-skeleton","title":"Segmentation skeleton","text":"<p>The cell segmentation is shown as labels (cells are fully colored by a unique number). The skeleton only shows the boundaries between cells. The option <code>Show segmentation skeleton</code> will add a layer that contains a binary representation of the cell junctions.  Press k to show/hide the skeleton layer.</p>"},{"location":"Display/#grid-options","title":"Grid options","text":"<p>This option displays a regular grid on top of the layers, to have a spatial reference of the area already corrected/treated. The number of rows and columns of the grid can be chosen in the <code>Display&gt;Grid options</code> panel as well as the size of the displayed lines of the grid (<code>Grid width</code> parameter).</p> <p>When <code>Add grid</code> is clicked, the grid is visible and a layer <code>EpicGrid</code> is added in Napari. By selecting this layer, it is possible to change the grid display style. Select the selection tool (full arrow) and click on a to select all lines of the grid and change the color/size with the top left panel of Napari. Each case of the grid is named <code>A0</code>, <code>A1</code>... to keep track of the position of each cell. The text can be hide/show by clicking on <code>display text</code> in that top left panel.</p> <p> Press g to show/hide the grid.</p> <p></p>"},{"location":"Edit/","title":"Edit","text":"<p>Edit the segmentation or cell properties</p> <p>Most edition options are in the Edit tab of the Main interface</p> <p>EpiCure offers several features to ease the manual correction of the segmentation and tracking of the cells (see correction options). </p> <p>Additionnal features are proposed:</p> <ul> <li>Cleaning options: general cleaning/checking of the segmentation and EpiCure files to ensure.</li> <li>Group cells options: classify cells into group (type) of cells.</li> <li>ROI options: apply some process to only some drawn region.</li> <li>Seeds options: to perform a watershed segmentation from several placed seed points. </li> </ul>"},{"location":"Edit/#segmentationtracking-correction","title":"Segmentation/tracking correction","text":"<p> Single frame edition:  EpiCure offers several options/shortcuts to ease the manual correction of the cell segmentation. The correction can be done on a single time frame (the current one) or it can concern a whole track. By default, the shortcuts for single time frame correction are activated (if the layer <code>Segmentation</code> is selected).</p> <p> Track level edition: To perform a track level edition, first press t to go into <code>track mode</code> and use the track level shortcuts. A message should appear to confirm that the track edit mode is active.  The other shortcuts are not active anymore in the <code>track mode</code>, only the shortcuts listed in the track mode table. To leave this mode and reactive the usual shortcuts, either finish your edit or press t again.  After the action linked to a shortcut has been done, the <code>track mode</code> is automatically existed. </p>"},{"location":"Edit/#shortcuts","title":"Shortcuts","text":"<p>The segmented cells are represented as label. There are several possibility for label edition in <code>Napari</code> + extra features from <code>EpiCure</code>. General shortcuts are documented here. You can see the complete list of Napari label layer shortcuts by going to <code>File&gt;Preferences&gt;Shortcuts</code> and selecting <code>Label layer</code>.</p> Shortcut/options <p>See Napari Label layer documentation for the label edition tools available by default in Napari (and the top left panel of the interface)</p> <p>EpiCure shortcuts are only active when <code>Segmentation</code> layer is selected</p> Segmentation correction Segmentation drawing Track level editing  Ctrl+ Merge two neighboring cells. Click and keep the button press from the first cell until the second cell. (See the image merging below.) Note that if the two cells are not touching, they cannot be merged Ctrl+ Split the cell accross the click. (See splitting image below). Drag-click accross the junction to create (from middle of the first cell to the middle of the second one). The first point of the click and the last one are used as seeds for an intensity-based watershed separation. Changing these two extreme points (seeds) can then improve the splitting Alt+ Split the cell along the drawn click. (See image splitting below.) Draw the junction, keeping the mouse pressed to split along the drawn line. If the drawn line spread over neighbor cells, it will not affect them 2 Switch to drawing mode (or click on the pencil tool). When it's selected, it will draw with the current value in the field below. The preicision (size) of your drawing can be set with <code>brush stroke</code> parameter [/] decrease/increase the brush stroke size 3 Switch to fill mode. The <code>fill</code> option replace directyl a whole label with the current new value. 4 Switch to label selection mode (picker). Set the current painting value ot the value of the clicked cell m Put the current drawing value to the maximal value +1. That unsures it's an unused value and can be used to draw a new cell. n Set the current drawing value to the first unused value and switch to paint mode Shift+n Set the current drawing value to the first unused value and switch to fill mode <code>preserve_labels</code> Freeze other labels than the current painting value. It's not possible to paint over an other value, so it ensures that you don't \"damage\" other segmentations when you edit one. p Toggle on/off the <code>preserve_labels</code> option Delete a cell. You can also put <code>0</code> as the current label, select <code>fill</code> mode and click on the cell to remove. w, then Ctrl+ From one cell to another to swap their values. j, then Ctrl+ draw one of several contiguous junctions to create new cell(s), defined by already existing cells around and this line <p>_ t activates track mode_</p> t, then , then  Link the two tracks under each click into one track (spatially or temporally). Merging spatially: if two tracks from the same time frame are clicked, the corresponding cells on all following frames will be merged into one cell (track). Merging temporally: if the two clicked cells are not in the same frame, the track will be merged temporally into one. If one clicked cell is not the last or first of its track, or if they are not in consecutives frames, the merging will be refused. Split the tracks before in that case. t, then Shift+ Split a track at the clicked position. A new track will be created from the current clicked frame to the last frame of the initial track. t, then Ctrl+Alt+ Erase all the remaining track starting from the current frame (erase all the painted cell). t, then Shift+ Keep clicked from one cell to another, to swap the two tracks value from the current frame until the end of each track. t, then Ctrl+ Manual tracking: at the first click, get the current cell value under the click and go to the next frame. At each new click, the initial value is set to the new cell and the viewer advanced to the next frame. Allows to manually define a track frame by frame. t, then Ctrl+ Finish the manual tracking t, then Alt+, then Alt+ Interpolate the segmentation between the two clicked cell. See image interpolate below. If segmentation is missing in one (or more) frame, this option interpolate the segmentation in between and add them to the track. Note that the interpolated segmentation is drawn only where the initial segmentation is black (background). If other labels are present in the interpolated area, it will not be affected <p>Merging cell :  Splitting cell : </p> <p>Interpolate in track :  </p>"},{"location":"Edit/#cleaning-options","title":"Cleaning options","text":"<p>Options to ensure clean and correct EpiCure files.</p>"},{"location":"Edit/#remove-border-cells","title":"Remove border cells","text":"<p>Remove all segmented cells that touch the spatial borders of the image. This parameter allows to get rid of cells that are partially outside of the imaged region and thus not complete. </p> <p>The parameter <code>Border width</code> allows to extend the requirement for the cells to be considered as fully inside. Cells that have at least one pixel at a distance less than <code>Border width</code> pixels from the image limits will be removed. </p> <p>Note that this action will be applied to all the time frames of the movie, and cannot be cancelled (if you wish to cancel it, you then need to restart EpiCure without saving the files). </p> Remove border option"},{"location":"Edit/#remove-mini-cells","title":"Remove mini cells","text":"<p>Allows to remove all cells smaller than the chosen threshold. The cell size is its area in pixels (number of pixels inside the cell). When this button is clicked, all frames will be treated.</p>"},{"location":"Edit/#cell-inside-another-merge","title":"Cell inside another: merge","text":"<p>Merge all cell fully included in another one into it.</p> <p>One recurrent segmentation error can be a large cell wrongly split in two cells, with one (false split) inside the other (correct one). This kind of error occurs when there is a large bright spot inside a cell, as for example into SOP (Sensory Organ Precursor) cells. </p> Merge cells that are inside another bigger one."},{"location":"Edit/#sanity-check","title":"Sanity check","text":"<p>This option performs several checks to ensure that the files follows EpiCure's standards and can fix some errors.</p> <p>For example, the tracks must not have frame gaps (missing one frame). If that happens, the <code>sanity check</code> option will detect it and fix it by splitting the gap in two different gaps. If some napari layers had been wrongly closed, this step will also re-open them. It also checks if the labels seemed ok or if something is weird.</p>"},{"location":"Edit/#group-cells-options","title":"Group cells options","text":"<p>Allows to create group of cells (classify them). Cells can be manually assigned to a cell group by clicking on them. This is useful to distinguish different type of cells visually or/and in the analysis in the Outputs options.</p> <p><code>Group name</code> allows to choose the name to give to a new Group of cells, or to assign a cell to the current <code>Group name</code> group. Write a new name to enter a new group, or choose in the list an existing group to insert the cell in that group.</p> <p>Cells can be manually assigned to the current group (see shortcuts below).</p> Shortcut/options Group Shift+ Assign the clicked cell to the current group (defined in <code>Group name</code>) Shift+ Remove the click cell from its current group (the cell will not be in a group anymore) <code>Show groups</code> Add a <code>Groups</code> layer in Napari, in which the cell are colored by the group they are in. Cells that are not in any group are black. <code>Reset groups</code> Remove all created groups. All cells are not in any groups. Group options interface <p>When the segmentation is saved by clicking on s when the <code>Segmentation</code> layer is active, the group information is also saved, in the EpiCure data file (file in the <code>epics</code> folder that ends with <code>_epidata.pkl</code>. When the movie is reopened in EpiCure, it will be automatically reloaded. </p>"},{"location":"Edit/#automatic-cell-group-assignement","title":"Automatic cell group assignement","text":"<p>Options are proposed to automatically assign several cells into one group.</p> <p><code>Cells inside ROI to group</code>: assign all the cells that are inside the currently selected ROI in the current frame (in the <code>ROIs</code> layer) to the current group (set by <code>Group name</code>). Cells that are assigned to a group are assigned all along the track (in all frames where this cell is present).  </p>"},{"location":"Edit/#group-cells-based-on-intensity-measurement","title":"Group cells based on intensity measurement.","text":"<p>To set this option, click on the <code>Group from track intensity...</code> button in the <code>Group options</code> panel. It opens-up an interface that allows to choose the criteria for the cell classification.</p> <p>The positive cells based on the selected criteria will be assigned to the current group name that can be set in the <code>Group name</code> parameter in the main interface.</p> <p>Choose the layer to use for the classification: the intensity in this layer will be measured in each cell. The layer can be a non EpiCure-layer . It only have to be opened in the same Napari and put at the same scale. For example it can be a probability map that are calculated by DeXtrusion. In the notebook EpiCure_DeXtrusion_Interaction.ipynb in this repository, dextrusion probability maps are overlayed with the EpiCure data and used to automatically classify SOP cells if they have been detected by DeXtrusion.</p> <p>For each track, the intensity will be measured in all the pixels of the cell at each time frame. You can choose whether you want to measure the mean value of these intensities, or the sum/max/min/median. Then fix a threshold to consider the track as positive if the measured value is above this threshold.</p>"},{"location":"Edit/#group-cells-according-to-events-dividingextruding","title":"Group cells according to events (dividing/extruding)","text":"<p>This option allows you to automatically group cells that will divide or extrude into a <code>Dividing</code> or <code>Extruding</code> group (or other group for other events). Click the <code>Group from events...</code> button to open the parameter interface of this option. You can choose which type of events to use to classify the cells. Click on <code>Apply</code> to automatically set all the cells that divide (or extrude, or other event types) into the <code>Dividing</code> group (or <code>Extruding</code>).</p> <p>If the option <code>show groups</code> of the main panel is selected, you will directly see which cells were assigned to this group when the processing will be finished.</p> Group cells that divide"},{"location":"Edit/#roi-options","title":"ROI options","text":"<p>This option allows to do operations on several neighboring cells at once, by selecting a region.</p>"},{"location":"Edit/#draw-a-selectionregion-of-interest","title":"Draw a selection/Region of Interest","text":"<p>When you select the <code>Selection option</code> in the <code>Edit</code> panel, press the first button <code>Draw/Select ROI</code> to draw a new shape or select an existing one. The shapes should be in the <code>Drawings</code> layer, by default not visible. When you click on this button, the layer will be visible and active.</p> <p>Choose the drawing tool that you want (ellipse, polygon, rectangle, triangle), the shape should be a closed one (so not a line). Draw the contour of the region that you want to use. The selected cells will be all the ones that have their centroids inside the drawn shape in the current frame. </p> <p>If the selected cells (labels) are present in other frames (tracking has been done), they will also be selected.</p>"},{"location":"Edit/#remove-cells-inside-roi","title":"Remove cells inside ROI","text":"<p>This will remove all the cells that are inside the currently selected shape/ROI. However, if some of those cells are \"checked\", they will not be removed.</p> <p>If no shape is selected, but there is exactly one shape in the <code>Drawings</code> layer, this shape will be selected. Otherwise, an error message will show off.</p>"},{"location":"Edit/#seeds-options","title":"Seeds options","text":"<p>This option performs an automatic segmentation of cells starting from manually placed points (seeds).</p>"},{"location":"Edit/#manual-positioning-of-seeds","title":"Manual positioning of seeds","text":"<p>To place/add seeds, you can either check the <code>Seed options</code> parameter in the <code>Edit</code> panel, press <code>create seeds layer</code> if it's not there yet and select the <code>+</code> button in the top left panel to add points. </p> <p>Shortcut: You can directly press e when the <code>Segmentation</code> layer is active, and each left-click will place a new seed if there is no cell below.  right-click to stop adding seeds.</p>"},{"location":"Edit/#automatic-positioning-of-seeds-from-previous-time-point","title":"Automatic positioning of seeds from previous time point","text":"<p>In the case of movies, we can use the information from the previous frame to place the seeds in the region that are not segmented yet. This option <code>Load seeds from previous time point</code> simply takes the centers of each cell of the previous frame as a seed.</p>"},{"location":"Edit/#automatic-segmentation-from-seeds","title":"Automatic segmentation from seeds","text":"<p>Several methods to segment the cells from the seeds are proposed: * Intensity-based: classic watershed method, starting filling from the seeds and stopping at high intensity gradient  * Distance-based: purely based on the distance to the seed points, voronoi-like segmentation. * Diffusion-based: random walk approach from the seeds. The segmentation is spread by diffusion from the seeds through similar intensity pixels in the image (sensitive to both the distance and the intensity).</p> <p>The parameter <code>max cell radius</code> controls the maximum cell size. It will constrained the segmentation for the <code>Distance-based</code> method and is used to crop the image around the seeds for computation efficiency with the two other methods.</p> <p>Select the segmentation method and click on <code>Segment cells from seeds</code> to run it. </p>"},{"location":"Inspect/","title":"Inspect","text":"<p>Inspect segmentation/tracks to reveal potential errors - Handle events</p> <p>Options to detect potential errors and navigate through them. Display also events as cell division and extrusions</p> <p>In EpiCure, an event is a point (a cell at a given time point) that has been detected as potentially wrongly segmented/tracked and might need manual correction (suspect) or that corresponds to a cellular event (division, extrusion..).</p> <p>Several features allows to detect possible segmentation/tracking errors and to display and navigate through these potential errors.</p> <ul> <li>Division events</li> <li>Extrusion events</li> <li>Find suspects on a single frame</li> <li>Find suspects by track inspection</li> <li>Visualisation/display</li> </ul> <p>All the current eventts are kept and saved when the segmentation is saved (by pressing s). They will be reloaded when an EpiCured file is loaded. The current number of events is indicated on top of the <code>Events</code> panel.</p> <p></p> <p>To remove all events, click on <code>Reset/Update some events...</code>. A new window will pop-up to let you choose which events to reset or update.</p> <p></p> <p>Click on <code>Reset all events</code> to delete all events. You can also choose to delete only one type of event by clicking on the corresponding buttons below.</p> <p>To remove events (division or extrusion) that correspond to cells that are on the border of the movie or on the boundary of the tissue, choose the options <code>remove if on border</code> or <code>remove if on boundary</code> and click on the corresponding type of event to remove.</p>"},{"location":"Inspect/#division-events","title":"Division events","text":"<p>Division events are detected based on the tracking graph. If cells has not been tracked yet, no division will be found. Division are indicated by a blue circle, placed on the first frame where the two daughter cells are visible and it contains the information of the mother cell label.</p> <p></p> <p>(Un)Select the option <code>show division</code> to (un)display division events. You can see the total number of divisions found written in the top of the <code>Inspect</code> panel.</p> <p>You can manually add a division event, or remove one. * To remove a division, the shortcut is the same as for removing any event: by default, press Control+Alt+Right-click on the event to remove. * To add a divison, do Control+Shift+Left clikc from one daughter cell to the other. EpiCure will detect automatically the most likely mother cell. If suspect events had been found on the two daughter cells or on the mother cell, they will be automatically removed when manually adding the division.</p>"},{"location":"Inspect/#extrusion-events","title":"Extrusion events","text":"<p>Extrusions are indicated by a red cross, placed on the last frame where the cell is still visible.</p> <p>Extrusion events are detected with the <code>Inspect</code> panel, in the inspect track option. It detects track that suddenly disappear (no daughter cell, not on the last frame, and not on the tissue boundary if the option <code>ignore boundary cells</code> is checked). As a sudden disparition of a track can also be due to a segmentation/tracking error, we added a constraint on the size of the cell to consider the disappearance as an extrusion. The cell in the last frame before disappearance should indeed be small if it is an extrusion. The threshold of cell area to consider it as an extrusion is chosen with the <code>cell area threshold</code> parameter.</p>"},{"location":"Inspect/#track-based-suspects","title":"Track-based suspects","text":"<p>Flag suspicious segmentation based on track examination.</p> <p></p>"},{"location":"Inspect/#ignoring-border-cells","title":"Ignoring border cells","text":"<p>Cells on the border of the tissu or imaged field are often flagged as potential errors as they can leave/enter the imaged region and thus have irregular tracks. To not flag these cells, check the <code>Ignore cells on</code> <code>border (of image)</code> and/or <code>tissue boundary</code> options. This will not flag any cells that touch the border of the image (for the <code>border</code> option) or that are in the periphery of the tissu (for the <code>boundary</code> option).  Note that you can also know when analysing data which cells are on image border or tissue boundary in the <code>Output&gt;measure cells</code> option if you select the <code>Boundary</code> and <code>Border</code> features.</p>"},{"location":"Inspect/#possible-errors-detection","title":"Possible errors detection","text":"<p><code>Flag track apparition</code> detects the sudden apparition of a new track in the movie (not on the first frame, and not on the borders of the image). If the cell is marked as a child of a division at that frame, it will not be flagged. (If two neighbor tracks are flagged in the same frame, it is likely to be an undetected division event)  </p> <p><code>Get divisions</code> detects potential division: two neighboring tracks that appear simultaneously in the movie, and with a parent cell that suddenly disappear in the previous frame, without any descendant. This option adds the detected divisions to the ones already present.</p> <p><code>Flag track disparition</code> detects the sudden disappearance of a track in the movie (not on the last frame). If the cell is marked as a parent of a division, it will not be flagged. If the cell area is below the selected threshold in the <code>cell area threshold</code> parameter, it will considered to be an extrusion and not be flagged.</p> <p><code>Get extrusions</code> will add an <code>extrusion</code> event for all track that finish without being followed by a division and with the last cell area below the <code>cell area threshold</code> parameter. Tracks that are only 1 frame long (cell is only present in one frame) are not flagged for an extrusion.</p> <p><code>Flag track gaps</code> find track that have gaps (no label in one or more frames within the track). If the option <code>Allow gaps</code> in the <code>advanced parameters</code> in the starting interface was not selected, there should not be any gaps.</p> <p><code>Flag track smaller to</code> flags as possibly wrong all tracks that are smaller in duration (number of frames) than the chosen parameter. For example, a cell that is present only in one frame on the whole movie is likely an error (except on the movie limits).</p> <p><code>Flag jump in track position</code>: a convenient way to notice errors in tracking or segmentation is to display the tracks (by default r shortcut). Errors are noticeable as sudden jump in the track (long line between two frames). This option is automatically searching for such jump in position within a track. The displacement between two consecutive frames of the tracking (can include a gap) is compared to the local average displacement within the track. If the difference in displacement is <code>jump in track position parameter</code> threshold above the other displacements, it will be flagged. Increase the value of the threshold to detect less potential jump in the track.</p> <p>A brutal and temporary (one or two frames only) change of value of a morphological/intensity feature of a cell within the track can reflect a segmentation error. The options <code>* variation</code> allow to flag such events. The associated parameter correspond to the amount of variation of the feature to flag it as suspect. Increasing it will decrease the sensitivity of the track inspection. The features that can be examined along the track are currently: size (area), shape (aspect ratio).</p>"},{"location":"Inspect/#inspect-tracks","title":"Inspect tracks","text":"<p>Click on <code>Inspect track</code> to launch the analyse with the selected parameters. It will delete all previously present suspects based on track before to run. Frame-based suspects are not affected.</p> <p>When the process is finished, the number of <code>suspects</code> will be updated in the top of the panel and you can see each event as a point (a cross for suspect, circle for division and triangle for extrusions) in the corresponding position in the movie. </p>"},{"location":"Inspect/#visualisation","title":"Visualisation","text":"<p> Press x to show/hide the suspect points.</p>"},{"location":"Inspect/#events-layer","title":"Events layer","text":"<p>This layer contains points (shown as cross) placed at the center of each cell suspected of being not correctly segmented. Several features can be used to detect suspects, either from a static features <code>see frame-based suspects</code> or from analyzing the tracks <code>Track options</code>. Cellular events are also displayed in this layer. Divisions are marked with blue circle by default.</p> <p>The score of a suspicious event is the number of suspicion (features) associated to that cell.</p>"},{"location":"Inspect/#display-options","title":"Display options","text":"<p>Use the interface <code>Display options</code> in the <code>Inspect</code> onglet (right panel) to change the display of the points (the size or the color).  You can choose the reference feature for coloring the events. If a cell was suspected by the selected feature, the point will appear red, otherwise if the suspicion came from another feature, the point will appear white. The <code>score</code> feature shows the number of suspicions (features) associated to the cell from white (1) to bright red (maximum).</p> <p><code>Go to event</code> will zoom on the selected event (numbered in <code>Event n\u00b0</code> parameter) and print in the Terminal window why this point was flag as a possible segmentation mistake or which cellular event it is.  Ctrl+Alt+Left click on a point to zoom on it and displays suspicion information</p> <p>To directly navigate between suspects,  Press Space to move from one suspect to another. The view will directly to go to the next suspect, zoom on it, and displays the information in the terminal. It will navigate between events that are currently displayed, other events will be skipped.</p> <p>If the segmentation/tracking is in fact correct, you can remove the point by clicking on <code>Exonerate current event</code>.  Ctrl+Alt+Right click to remove the clicked point from event list</p>"},{"location":"Inspect/#shortcuts","title":"Shortcuts","text":"<p>EpiCure proposes also shortcuts to handle events (edit, navigate, display) without having to select this layer, keeping the <code>Segmentation</code> layer selected. General shortcuts are documented here.</p> Shortcut/options <p>EpiCure shortcuts are only active when <code>Segmentation</code> layer is selected</p> Event navigation Event edition  Ctrl+Alt+ Zoom on the clicked event and display its information. The information (type of event, label) is written in the Terminal window. Ctrl+Alt+ Remove the event under the click. Space Move and zoom on the next event. This option navigates between events that are currently displayed (checked). Ctrl+Shiftt+ Add a division. Drag the click from one daughter cell to the other. EpiCure will determine the most likely mother cell. Ctrl+Shiftt+ Add an extrusion. Click on the last cell of the track to select the moment of extrusion."},{"location":"Inspect/#frame-based-suspects","title":"Frame based suspects","text":"<p>Cells can be suspected of being un-correctly segmented based on several static features, if their values fall out of range. When a cell is suspected, a point will be added in the Suspects layer at the center of the cell in the frame where the suspicion has been raised.</p> <p>From a static frame, several features can be measured and evaluated for out of range values:</p> <ul> <li>Cell area</li> <li>Tubeness</li> <li>Solidity</li> <li>Intensity</li> </ul> <p>Click on the desired feature button to launch the feature inspection.</p>"},{"location":"Inspect/#options","title":"Options","text":"<p><code>only current frame</code>: if it is checked, only the current frame will be inspected for the given feature. Else, the inspection will be done on each frame.</p>"},{"location":"Inspect/#shortcuts_1","title":"Shortcuts","text":"<p>The active layer must be the <code>Segmentation</code> layer for the shortcuts to work.</p>"},{"location":"Inspect/#cell-area","title":"Cell area","text":"<p>This feature measure the cell area in all frames (or only current frame if the option is checked) and test if it is above/below chosen threshold. Each cell (at each time point) below/above the two parameters around the <code>&lt; area (pix^2) &lt;</code> buttons will be flagged as suspect for area.</p> <p>The parameters are in pixel^2 unit. Use <code>0</code> for the min area parameter to keep all small cells, and a very high value for the max area parameter to keep all large cells.</p>"},{"location":"Inspect/#intensity","title":"Intensity","text":"<p>This feature consider the ratio of intensity of the inner cell region compared to the cell periphery. Indeed, the peripheric part of the cell containing the junction should be much brighter while inside the cell should not be dark. If the ratio is above the chosen threshold, the cell will be marked as suspicious.</p>"},{"location":"Inspect/#tubeness","title":"Tubeness","text":"<p>This feature consider the ratio of linearity of the inner cell compared to the cell periphery. Indeed, the peripheric part of the cell containing the junction should be linear while inside the cell it should not be linear at all. The \"linearity\" is quantified by the tubeness of the intensity image. When the ratio is above the chosen threshold, the cell will be marked as suspicious.</p>"},{"location":"Inspect/#solidity","title":"Solidity","text":"<p>Looks at the cell shape. Cell as detected as outliers if their solidity is greater or smaller than the vast majority of the cells in the current frame following Tukey's outlier scheme:</p> <pre><code>solidity &lt; Q1 - k*(Q3-Q1)\nsolidity &gt; Q3 + k*(Q3-Q1)\n</code></pre> <p><code>Q1</code> and <code>Q3</code> are the 1st and 3rd quartiles. <code>k</code> controls the range to consider a cell as outlier and can be chosen in the interface.</p>"},{"location":"Installation/","title":"Installation","text":""},{"location":"Installation/#from-napari-interface","title":"From Napari interface","text":"<p>EpiCure is a Napari plugin, in python.  You can install it either through an already installed Napari instance by going in Napari to <code>Plugins&gt;Install/Uninstall</code>, search for <code>Epicure</code> and click <code>Install</code>. You could have version issues between the different modules installed in your environment and EpiCure dependencies, in this case it is recommended to create a new virtual environnement specific for EpiCure.</p>"},{"location":"Installation/#from-virtual-environnement","title":"From virtual environnement","text":"<p>To install EpiCure in a new environnement, you should create a new virtual environnement or activate an exisiting compatible one.</p>"},{"location":"Installation/#create-a-new-virtual-environement","title":"Create a new virtual environement","text":"<p>You can create a virtual environement with venv or anaconda (you may need to install anaconda, see here: on windows, on macOS or on linux ). </p> <p>Then use the Anaconda interface to create a new virtual environement with the desired python version, or through the Terminal.</p> <p>For example, in a terminal, once conda is installed, you can create a new environnement by typing: <pre><code>conda create -n epicurenv python=3.10\n</code></pre></p>"},{"location":"Installation/#install-epicure","title":"Install EpiCure","text":"<p>Once you have created/identified a virtual environnement, type in the terminal: <pre><code>conda activate epicurenv\n</code></pre> to activate it (and start working in that environnement).</p> <p>Type in the activated environnement window:</p> <p><pre><code>pip install epicure \n</code></pre> to install EpiCure with its dependencies.</p>"},{"location":"Installation/#compatibilitydependencies","title":"Compatibility/Dependencies","text":""},{"location":"Output/","title":"Outputt","text":"<p>Options to measure and export segmentation/events/tracks</p> <p>Measurement and plotting options are/will be proposed here, as well as options to export the segmentation/measurements to use in other analysis softwares</p> <ul> <li>Apply on: define current selection</li> <li>Export to extern plugins</li> <li>Export segmentations</li> <li>Export events</li> <li>Measure cell features</li> <li>Measure track features</li> </ul>"},{"location":"Output/#define-current-selection","title":"Define current selection","text":"<p>You can choose which cells to analyse/export with the <code>Apply on</code> option in the interface: * <code>Only selected cell</code> will measure/export only the currently selected label/cell. Its value can be seen and modified in the left panel under <code>label</code>. You can select <code>show selected</code> option in that panel to see only this cell. * <code>GroupName</code> will measure/export all the cells in the corresponding Group (that have beend defined with the <code>Edit&gt;Group</code> options. To see which cells are in the group, you can select the option <code>see group cells</code> in the <code>Edit&gt;Group</code> panel of Epicure. * <code>All cells</code> will measure/export all the cells in the <code>Segmentation</code> layer.</p>"},{"location":"Output/#export-to-other-plugins","title":"Export to other plugins","text":"<p>The output of EpiCure are also compatible with other Napari plugins, and this panel allows you to communicate directly with those plugins. It will open a new Napari window, with the corresponding plugin launched, and the necessary layer. You need to have these plugins already installed in Napari, or install them in the <code>Plugins</code> panel of Napari.</p> <p>Currently, we propose direct export to: * Griotte Napari plugin that allows to visualize/export the connectivity graphs between the cells. * Cluster-Plotter Napari plugin that allows to cluster objects based on their properties and interactive visualisation of the results.</p>"},{"location":"Output/#save-segmentations","title":"Save segmentations","text":"<p>The curated segmented and tracked file can be exported in several formats to be used directly in other softwares/pipelines.</p> <p>Click on the check box on top of the <code>export segmentation</code> panel to remove it when you don't need it anymore.</p>"},{"location":"Output/#roi-export","title":"ROI export","text":"<p>The button <code>Save ROI(s)</code> allows to export the segmentation as Fiji ROIs. It will export only the selected set of cells (the selected cell, the checked cells or all the cells). In all cases, it creates a ROI file for each cell, containing the contour of the cell at all time frames where it is present. The file(s) are saved in the output folder, named <code>*imagename*_cell_*celllabel*.zip</code>, for each cell.</p>"},{"location":"Output/#save-segmentation","title":"Save segmentation","text":"<p>The button <code>Save segmentation(s)</code> allows to save the label image of the segmented cell(s) depending on the selection (only the selected cell, cells in a given group or all the cells).</p>"},{"location":"Output/#save-skeleton","title":"Save skeleton","text":"<p>Allows to save the skeleton: the binary of the junctions, of the current selection (only selected cells, cells of a given group, or all cells). The file will be saved in the output folder. The skeleton can also be displayed by pressing k&gt;/kdb&gt; when the segmentation layer is active."},{"location":"Output/#export-events","title":"Export events","text":"<p>Export events (in the <code>Inspect</code> onglet) to use in extern plugins/softwares as <code>Fiji</code>. </p> <p>You can choose which type of events to export (suspect events, divisions, extrusions...). For this click the <code>Choose events</code> button and select the event types to export. Each type of event will be exported separately.</p> <p>Then choose the type of format to export the event. Currently, only <code>Fiji ROI</code> is proposed. It will save the list of events as <code>Fiji point ROI</code> in a <code>.zip</code> file which can be open in Fiji through the <code>ROI Manager</code>. This export format is also compatible with <code>DeXtrusion</code> so that EpiCure can be used to create a training dataset for DeXtrusion.</p>"},{"location":"Output/#measure-cell-features","title":"Measure cell features","text":""},{"location":"Output/#features-selection","title":"Features selection","text":"<p>You can choose which features will be measured and displayed in the table. For this, click on the button <code>Choose features</code> in the panel. A window will pop-up with the list of available features. Check the ones to measure.  If features that relies on intensity are checked, you can choose on which channel(s) you want to do the measurement. For example, if the movie has two channels (the junction and another staining), you can select both to measure the intensity of the cell in both channels. For this select, the desired channels in the displayed list.</p> <p>Note that if you save the current settings (see Preferences), the selected features will be also saved as default features.</p>"},{"location":"Output/#features-table","title":"Features table","text":"<p>The feature table contains measurement of cell properties based on the segmentation. The table will be created/updated when clicking on the <code>Create features table</code> button. </p> <p>If you click on one value in the table, it will show the corresponding cell at the corresponding time frame.  The table can be sorted by a given column by clicking on the column name.</p>"},{"location":"Output/#temporal-graph","title":"Temporal graph","text":"<p><code>Table to temporal graph</code> button opens a new panel to choose a feature to analyse temporally. With this option, you can display a graph of the evolution of the value of a measured feature in time. The individual curves of each cell will be displayed. If you have created Groups, you can also display the average value by Group.</p> <p>A dotted vertical line in this panel indicates at which frame you are currently in the main Napari panel in the displayed layers. If you move the current frame in the main Napari interface, the vertical line will move accordingly.</p> <p></p> <p>Starting from version 0.2.6, temporal plots rely on <code>plotly</code> python library instead of <code>matplotlib</code> previously. This allows for more interactivity as you can zoom in/out, hover with the mouse on the curves to see the current value, select label(s) to display. However, the display is very slow for a large amount of lines to plot (if there are more than 2000 labels/cells). For simplicity, EpiCure will only display a random subset of the labels when this is the case but if you save the plot data, all data will be saved. </p> <p></p>"},{"location":"Output/#saving-temporal-plot","title":"Saving temporal plot","text":"<p>You can save either the current plot image by clicking the <code>save plot image</code> button, or the raw values used to do the plot (the x and y values, as a <code>.csv</code> file) with the <code>save plot data</code> button. By default, the data are saved with one row by value (each row one label, one frame and the corresponding value of the plotted feature). To save instead the data with one column for each label, select the option <code>Arranged data by label</code> in the bottom right of the plot interface (option available from EpiCure 0.2.6).</p> <p></p>"},{"location":"Output/#feature-map","title":"Feature map","text":"<p>Each measured feature (in the table) can also be displayed as a colored map, where each cell is colored by the value of this feature.  For this, select the feature to map in the <code>Draw feature map</code> interface, and a new layer will be added in the list of layers on the left panel of Napari. You can change the colormap colors in the top-left panel of Napari by selecting this layer, and then use the <code>colormap</code> option.</p> <p></p>"},{"location":"Output/#draw-orientation","title":"Draw orientation","text":"<p>To draw each cell main orientation, click the button <code>Draw cell orientation</code>. You must have measured the cell features before, and selected at least the <code>centroid</code> and <code>orientation</code> features.  If you also selected the <code>eccentricity</code> feature, the drawn line length will reflect the cell orientation strength (the eccentricity). Otherwise, the cell orientation line will be the same length for all cells.</p> <p>This option will add a layer <code>CellOrientation</code> that contains the drawn lines of each cell orientation (main axis).</p> <p></p>"},{"location":"Output/#statistiques-table","title":"Statistiques table","text":"<p>Once the table has been calculated, you can interactively look at the statistical distribution of the selected features with this option. It uses the skrub module that should be installed in your virtual environment to use it <code>pip install skrub</code>.</p> <p>This option will open an <code>html</code> page that contains the table and statistics for each column. You can click on the column/case to have more information on the distribution of the selected feature. The onglet <code>Association</code> in the html page gives information on the co-dependency of features. </p> <p> Be careful that these statistics are only exploratory and do not take into account the dependencies between data (temporal dependencies for a cell with the same label, cell from the same lineage...).</p> <p></p>"},{"location":"Output/#measure-track-features","title":"Measure track features","text":"<p>Measures, displays and export track features.</p> <p>This option allows you to measure track related features, as the track length, mean area of the cell along the track... It displays a table of the measured features of each track. </p> <p>Options to plot or interact with these measures will be added in the development of EpiCure plugin.</p>"},{"location":"Preferences/","title":"Preferences","text":"<p>Settings to customize EpiCure to user specific preferences</p> <p>Set your preferences by going to <code>Plugins&gt;Epicure&gt;Edit preferences</code></p> <p>You can customize EpiCure to your specific usage by redefining the key or mouse shortcuts and by saving your default plugin state and parameters.</p> <p>For this, EpiCure generates a file containing all the user settings in your home directory, in the <code>.napari</code> folder (which will be created if not there already). The file will be called <code>epicure_preferences.pkl</code>. It can be deleted, but then all the user settings will be lost.</p> <p>At each start of EpiCure, this preference file, if present in the defined path (<code>$home_directory/.napari/epicure_preferences.pkl</code>) will be loaded and applied.</p>"},{"location":"Preferences/#update-epicure-display-settings","title":"Update EpiCure display settings","text":"<p>To save your prefered plugin set-up (visible options, checked options, some parameter values, default display...), go to the Display option in EpiCure and click on the button <code>Set current settings as default</code>.</p> <p>For example, if you displayed the labels as a contour of width 2 (instead of full filled labels), next time you start EpiCure, it will directly display the label as contour of width 2. If you activated the grid visualisation, it will also be directly active.</p>"},{"location":"Preferences/#redefine-epicure-shortcutscolors","title":"Redefine EpiCure shortcuts/colors","text":"<p>You can set-up several EpiCure default ergonomic parameters as the choice of shortcuts or display colors of the interfaces.  For this, open the <code>Preferences</code> option in <code>Napari&gt;Plugins&gt;EpiCure&gt;Edit preferences</code>.</p>"},{"location":"Preferences/#edit-shortcuts","title":"Edit shortcuts","text":"<p>You can redefine EpiCure shortcuts to put your favorite keys instead of EpiCure default ones (reminder, you can see the full list of EpiCure shortcuts by pressing a when EpiCure is open). A panel will open on the right side, with a list of shortcuts for each type of EpiCure action (General, Edit, Track, Suspect, Output, Display), under the onglet <code>Shortcuts Config.</code></p> <p></p> <p>Select the one you wish to edit, change the corresponding shortcut by putting your favorite key instead of the default one.</p> <p>\ud83d\uddb1\ufe0f If the shortcut involves a mouse click, a list of optionnal key (Control, Shift) and of mouse click are proposed instead of a possible key letter.</p> <p>Click on the button <code>Save preferences</code> when all shortcuts have been modified to set them.</p> The new shortcut configuration will be active only at the next EpiCure session. <p>If you already have an EpiCure opened, restart it to apply the new shortcuts.</p> The compability of shortcuts is not checked <p>Avoid to use twice the same shortcut as there is no (in the current version) screening of the shortcut to check their unicity </p>"},{"location":"Preferences/#edit-interface-colors","title":"Edit interface colors","text":"<p>To change the colors in the interface (e.g. the buttons color), select the onglet <code>Display Config.</code> Click on the type of interface to change the color.  Each button is colored by its current color.  When you click on it, an interface pops-up to allow you to choose a new color and the button color will be modified when you click on <code>Ok</code> </p>"},{"location":"Segment-option/","title":"Segment option","text":""},{"location":"Segment-option/#segment-with-epyseg","title":"Segment with EpySeg","text":"<p>When starting EpiCure, once you have selected the movie to process and the junction channel, you have to load the file containing the segmentation of the epithelia movie. If you haven't done it yet, you can use the <code>Segment now with EpySeg</code> button that appears in the <code>Start EpiCure</code> interface.  This option uses the napari-epyseg plugin to directly run EpySeg on the movie. It will run with the default parameters. If you want to change some parameters, either use directly the napari-epyseg plugin within Napari (limited number of options) or use the original distribution of EpySeg (you can launch it with <code>python -m epyseg</code> in your python environement).</p> <p>Note that the option requires to install the napari-epyseg plugin which is not installed by default in the EpiCure release. You can install it by typing <code>pip install napari-epyseg</code> in the environement or by going to <code>Plugins&gt;Install\\Uninstall Plugins</code> in Napari interface.</p>"},{"location":"Start-epicure/","title":"Start EpiCure","text":"<p>Start EpiCure: load the movies and metadata</p> <p>Choose <code>Start epicure</code> in Napari <code>Plugins&gt;Epicure</code> to open it. </p>"},{"location":"Start-epicure/#loading-the-movies","title":"Loading the movies","text":"<p>In the <code>Start EpiCure</code> step, you have a dedicated interface in the right part of the main interface.</p> <p>The first file to choose is the movie containing the epithelial staining, with th <code>image file</code> parameter.  It should be 2D(+time), .tif file. </p> <p>If the file contains several chanels, the plugin should detect it and show the <code>junction_chanel</code> parameter, to choose the chanel that contains the junction staining. The plugin will display only this chanel. If you wish to also see the other chanels, use the option <code>show other chanels</code> in the advanced parameters panel.</p> <p>The second file is the segmentation of this movie (also a <code>.tif</code> file). It can be a binarized file of the junctions (skeletonized) or a labelled file (each cell is filled by a unique number).</p> <p>Note that if you haven't done the segmentation yet, there's an additional option in EpiCure to directly run EpySeg on the loaded movie. </p> <p></p>"},{"location":"Start-epicure/#advanced-parameters","title":"Advanced parameters","text":"<p><code>output dirname</code> is the name of directory where all files generated by <code>EpiCure</code> will be saved. By default, it is placed in the input movie directory and called <code>epics</code>.</p> <p><code>show other chanels</code> will display the other chanels of the original movie.</p> <p><code>epithelial cells</code>: EpiCure has been developed and optimized for epithelia movies, with jointive cells. However, you can still use it for non jointive cells by unselecting this option. Note that some options might not be usable in that case</p> <p><code>process frames parallel</code>: if this is checked, some operations will be performed in parallel, processing multiple frames at the same time. The number of parallel threads run together is defined by the parameter <code>nbparallel_threads</code>, which is by default 75% of the computer's cpu numbers. </p> <p><code>verbose level</code> defines the amount of messages that are printed to the user. By default, some information or warning messages are shown. If this parameter is put to 0, very few messages will appear while if it's put to 3, a lot of information useful for debugging will be shown.</p>"},{"location":"Track/","title":"Track","text":"<p>Track temporally the cells</p> <p>Most track options are in the Track tab of the Main interface</p> <p>EpiCure handles tracks by using the same label for the corresponding cell accross frames. One cell has a unique number (its label), displayed with a specific color assigned by Napari, that corresponds to the track number as well. The file containing the segmentation with the labelled cells is thus enough to reconstruct the tracks.</p> <p>Cell divisions are organised in a graph and displayed with the <code>events</code> structure (see Inspect). The graph is a NetworkX object and contains as keys the daugther cells and as values the parent cell. This implementation is compatible with laptrack's output and Napari Track layer.</p> <p>EpiCure opens a Tracks layer in Napari that displays the trajectories of each cell (label) centroid.</p> <p>This layer is very slow to update, so it is NOT updated at each action.</p> <p>A local version of the tracks is kept up-to-date with the modifications done, but not the displayed version. To update the display to the latest version, click on Update tracks.</p> <p>With the EpiCure Track panel, you can choose a tracking algorithm and tune its parameter.  It's also possible to track the cells in an other software/plugins. </p>"},{"location":"Track/#importload-tracking","title":"Import/Load tracking","text":"<p>To use tracking from an external software, the cells need to be labelled by their track number to be loaded in EpiCure.  Cell divisions/merges will not be loaded from external tracks.</p>"},{"location":"Track/#division-detection","title":"Division detection","text":"<p>Cell divisions can be detected by going in the Inspect interface, and select <code>get_divisions</code> in the <code>Track options</code> panel. This option looks for two tracks that appear at the same frame, are touching and have a potential parent track (a track ending in the previous frame without being in a division or extrusion event). </p> <p>Thus, if you load results from an external tracking software, as TrackMate, a division event should be detected without having to load the division information from that software (the format of the division implementation can vary between software so it can be convenient to not rely on it).</p>"},{"location":"Track/#load-trackmate-tracks","title":"Load TrackMate tracks","text":"<p>In particular, you can perform the cell segmentation and tracking in TrackMate and use the Action <code>Export label image</code>. Then load this labelled image as the segmentation file in EpiCure and you will directly get the tracks. However, the division and extrusion will have to be detected within EpiCure afterward.</p>"},{"location":"Track/#track-with-laptrack","title":"Track with Laptrack","text":"<p>Tracking within EpiCure can be performed with the Laptrack module. Laptrack will optimize the linking of the cell from one frame to another, and can also include the possibility for cell division or cell merging. As in our movies, we don't have cell merging biologically, we disabled this feature but it can easily be integrated.</p>"},{"location":"Track/#laptrack-centroids","title":"Laptrack centroids","text":"<p>With this option, Laptrack considers the distance between the centroid of the cells from one frame to another to optimize the linking. Thus this method has good performance in general when the cell's center displacement are smaller than the size of the cell itself (it's less likely to confuse the cell with its neighbor).</p>"},{"location":"Track/#laptrack-overlap","title":"Laptrack overlap","text":"<p>With this option, Laptrack considers the overlap of the segmented cells from one frame to another to optimize the linking. This method relies on more information than taking only the cell's centroid as it takes into account the full surface distances. It necessitates the cell motion to be small enough for the cell to stay mainly within the previous cell surface.</p>"},{"location":"Track/#add-feature-cost","title":"Add feature cost","text":"<p>With both options, it's also possible to take into account the size or the shape of the cell in the linking calculation. This will improve the tracking when the cell is similar from one frame to another so it will increase the capacity of the algorithm to \"recognize\" the cell. This can be done by checking the <code>add feature cost</code> in the interface.</p>"},{"location":"Track/#drift-correction","title":"Drift correction","text":"<p>This option allows to take into account local drift in the tracking algorithm. When there is a fast local movement of all cells in the same direction, the algorithm is more likely to fail as the distance between the cell centroids or their overlaps will be higher than the distance/overlap with another cell.  This helps to correct it, by calculating the local overall drift and removing this drift from the distance calculation.</p> <p>Local drift is estimated with optical flow. This is however quite slow to calculate, so adding this option will significantly increase the computation time.</p>"},{"location":"Track/#shortcuts","title":"Shortcuts","text":"<p>You can select the <code>Track</code> layer in the left part of the interface to change the display properties of this layer. EpiCure proposes also a few shortcuts to change this display directly without having to select this layer, keeping the <code>Segmentation</code> layer selected. General shortcuts are documented here.</p> Shortcut/options <p>EpiCure shortcuts are only active when <code>Segmentation</code> layer is selected</p> Track display  r Show/Hide the Track layer l Color tracks by lineage (color of the first mother cell)"}]}